#######
# PV5 #
#######
source("data-raw/hemibrain/startupHemibrain.R")

# First read all LHNs in the related cell body fibres
### Use plot3d(), nlscan() and find.neuron() to choose IDs.

# Group X
pv5x = c("728974338", "5812980156", "577546843", "727838223", "451355706",
         "573333903", "5813012375", "264779403", "546511447", "573683455",
         "573333284", "572651463", "357224041", "609941228", "604368022",
         "696432315", "5813010159", "5813083717", "911012735", "541663112",
         "5813047130", "5812980282", "973047668", "759582005", "326159907",
         "295805243", "5813010180", "5813094592", "296153261", "573056433",
         "480931947", "5813047174", "390599254", "359529027", "880323994",
         "572647105", "573708714", "5813056026", "356144721", "419216386",
         "451646125", "485387561", "605063393", "702010197", "700982749",
         "639958133", "729228602", "264783939", "481268762", "573333575",
         "5813010200", "602999843", "608240515", "329220439", "633684017",
         "265120324", "696082279", "5813009281", "573670049", "5813077562",
         "579576294", "454706029"
)
pv5y = c("360587642", "513050445", "705722260", "611274992", "699203489",
         "636798093", "361269751", "732354059", "455751103", "360254994",
         "391273276", "573328182", "485728655", "422640861", "424025668",
         "611620813", "768132738", "763034485", "423343583", "728836965",
         "422307542", "5813009429", "5813078563", "732034061",
         "5812981264", "5812981543", "5813020828", "457175171", "487143497",
         "457196643", "673366098", "579916831", "580244333", "5813048099",
         "361964245", "5812981168", "851027931",
         "5813048346", "456083341", "912049625", "487795196", "513058708",
         "634741770", "794333532", "482974860", "641631962", "573005505",
         "5901196176", "487467388", "641631806", "484355342", "701577869",
         "697853509", "731917767", "730325440", "575750788", "5813047222")
pv5z = c("294787849", "579575594", "328611004", "517514142")
pv5 = unique(c(pv5x,pv5y,pv5z))

## The PV5 assembly contains 3 cell body fibre bundles and 3 hemlineages

### CBFs:
### x: PDL05^SFS1 PDL08^pLH2 PDL19^SFS3 PDL23^pLH10
PDL05 = neuprint_read_neurons("PDL05")
PDL05 = PDL05[names(PDL05)%in%hemibrain.lhn.bodyids]
PDL23 = neuprint_read_neurons("PDL23")
PDL23 = PDL23[names(PDL23)%in%hemibrain.lhn.bodyids]
PDL22 = neuprint_read_neurons("PDL22")
PDL22 = PDL22[names(PDL22)%in%hemibrain.lhn.bodyids]
PDL19 = neuprint_read_neurons("PDL19")
PDL19 = PDL19[names(PDL19)%in%hemibrain.lhn.bodyids]
pv5.hemi = c(PDL05,PDL23,PDL22,PDL19)

### Re-define some of these CBFs
sd = setdiff(pv5, names(pv5.hemi))

### Hemilineages:
#### ItoLee: Dl2_lateral, DL1_dorsal, DL2_medial
#### Hartenstein: CP3_lateral, CP2_dorsal, CP3_medial
gs[pv5x,"ItoLee_Hemilineage"] = "Dl2_lateral"
gs[pv5x,"Hartenstein_Hemilineage"] = "CP3_lateral"
gs[pv5y,"ItoLee_Hemilineage"] = "DL1_dorsal"
gs[pv5y,"Hartenstein_Hemilineage"] = "CP2_dorsal"
gs[pv5z,"ItoLee_Hemilineage"] = "DL2_medial"
gs[pv5z,"Hartenstein_Hemilineage"] = "CP3_medial"
gs[pv5.primary,"ItoLee_Hemilineage"] = "primary"
gs[pv5.primary,"Hartenstein_Hemilineage"] = "primary"


##############################
# Make and review cell types #
##############################


############
### PV5x ###
############



































a = c("605063393", "573708714", "485387561", "5813083717")
gs[c(a),"cell.type"] = "PV5a"

b = c("572647105", "5813047174", "451646125", "5813010159")
gs[b,"cell.type"] = "PV5b"

c = c("973047668")
gs[c,"cell.type"] = "PV5c"

d = c("5812980282")
d.d = c("VGlut-F-800074")
gs[c(d,d.d),"cell.type"] = "PV5d"

e = c("541663112", "5813047130")
gs[e,"cell.type"] = "PV5e"

f = "357146296"
gs[f,"cell.type"] = "PV5f"

g = c("880323994", "729228602", "759582005")
gs[g,"cell.type"] = "PV5g"

h = c("480931947", "911012735", "5813010180", "5813094592")
h.h = c("Gad1-F-900040")
gs[c(h,h.h),"cell.type"] = "PV5h"

i = c("573056433", "295805243", "296153261")
gs[i,"cell.type"] = "PV5i"

j = "5813077562"
gs[j,"cell.type"] = "PV5j"

k = c("390599254", "419216386")
gs[k,"cell.type"] = "PV5k"

l = c("356144721", "359529027", "326159907", "5813056026")
gs[l,"cell.type"] = "PV5l"

m = "357224041"
gs[m,"cell.type"] = "PV5m"

n = c("700982749", "728974338")
n.n = c("L374#3","L374#10","L374#2", "L374#4")
gs[n,"cell.type"] = "PV5n"

o = c("608240515", "639958133", "702010197")
o.o = c("Gad1-F-300312", "Gad1-F-200177", "L374#9", "L374#5","L374#6","L374#8")
gs[c(o,o.o),"cell.type"] = "PV5o"

p = c("265120324", "481268762", "264779403", "264783939")
p.p = c("Gad1-F-700139", "Cha-F-500250", "Cha-F-700211",
        "L163#1", "Gad1-F-000349", "Cha-F-600232", "L163#2")
gs[c(p,p.p),"cell.type"] = "PV5p"

q = c("5813009281", "572651463", "451355706", "5812980156")
q.q =c("Cha-F-200402", "Gad1-F-100091")
gs[c(q,q.q),"cell.type"] = "PV5q"

r = c("5813010200", "602999843", "573333575", "329220439", "5813012375")
r.r = c("Gad1-F-900098", "Gad1-F-300321","L1554#2",
        "MB036B#1", "Gad1-F-100023", "L1554#1", "Cha-F-800045")
gs[c(r,r.r),"cell.type"] = "PV5r"

s = c("633684017", "696082279")
gs[c(s),"cell.type"] = "PV5s"

t = c("696432315", "727838223")
t.t = c("Cha-F-100457","120618c0","131118c3")
gs[c(t,t.t),"cell.type"] = "PV5t"

u = c("573670049", "579576294")
u.u = c("VGlut-F-400058", "L166#4", "Gad1-F-400304", "Gad1-F-200199",
        "120712c1", "120619c1","120710c0", "Cha-F-500138", "Cha-F-800011",
        "579576294","L166#6","SS01372#3")
gs[c(u,u.u),"cell.type"] = "PV5u"

v = c("573333284", "609941228", "546511447", "577546843",
      "604368022", "573333903", "573683455", "120813c0")
v.v = c("Gad1-F-900137", "Gad1-F-500244", "Gad1-F-500180", "Gad1-F-400275", "120708c1",
        "Gad1-F-200403", "Gad1-F-200289", "Cha-F-400324", "Gad1-F-100357", "Gad1-F-200220",
        "120628c1", "Cha-F-000427", "L378#2", "Gad1-F-100099", "L166#1", "L224#1", "Gad1-F-000338",
        "Gad1-F-300298", "L224#3", "SS01372#1", "L166#5", "Cha-F-300204", "120216c0", "Gad1-F-000393",
        "120914c0", "130118c0", "Cha-F-100394", "Cha-F-300241", "Cha-F-400179", "Cha-F-500187", "Gad1-F-100093",
        "Gad1-F-100247","Gad1-F-100322", "Gad1-F-400226", "Gad1-F-400226","Gad1-F-400335","Gad1-F-600214","L166#2",
        "L166#3", "L224#2","L291#1","L378#1","SS01372#2")
gs[c(v,v.v),"cell.type"] = "PV5v"


############
### PV5z ###
############

a = "579575594"
gs[a,"cell.type"] = "CP3_medial_a"

b = "328611004"
b.b = c("TH-M-100016")
gs[c(b,b.b),"cell.type"] = "CP3_medial_f"

c = "294787849"
gs[c,"cell.type"] = "CP3_medial_c"

d = "517514142"
d.d = c("TH-M-300021","TH-M-200014")
gs[c(d,d.d),"cell.type"] = "CP3_medial_d"


############
### PV5y ###
############

a = c("5813078563", "732034061")
a.a = c("Gad1-F-300290","L528#1")
gs[c(a,a.a),"cell.type"] = "PV5a"

b = "487143497"
gs[b,"cell.type"] = "PV5b"

c = c("457175171", "579916831")
c.c = c("E0585-F-200015", "E0585-F-300042","Gad1-F-400259")
gs[c(c,c.c),"cell.type"] = "PV5c"

d = "5813020828"
gs[d,"cell.type"] = "PV5d"

e = c("457196643", "673366098", "5812981264", "5812981543") # MBONs
e.e = c("Cha-F-800086","E0585-F-200005","Gad1-F-700088","Gad1-F-400293")
gs[c(e,e.e),"cell.type"] = "PV5e"

f = c("455751103", "485728655")
f.f = c("E0585-F-300058", "Cha-F-100068", "130220c1", "130606c1", "130704c2",
        "E0585-F-300069","121212c0","121213c0", "130313c1","130710c3", "E0585-F-300050",
        "E0585-F-400009")
gs[c(f,f.f),"cell.type"] = "PV5f"

g = c("422307542", "5813009429", "423343583", "728836965")
g.g = c("Gad1-F-800215", "Gad1-F-300155", "E0585-F-400018","Gad1-F-000125",
        "E0585-F-500009", "Cha-F-100141", "L1293#16","Cha-F-600051", "JJ99")
gs[c(g,g.g),"cell.type"] = "PV5g"

h = c("636798093", "422640861", "424025668", "699203489")
h.h = c("Gad1-F-200232", "L1293#1", "L173#7", "L1293#2", "L173#2", "130711c1",
        "E0585-F-500008", "E0585-F-400008", "E0585-F-300013", "E0585-F-300043", "E0585-F-300071",
        "130816c2", "E0585-F-300052", "E0585-F-300073", "E0585-F-400013", "E0585-F-300020", "L1293#14",
        "L178#2", "130208c1", "Gad1-F-200255", "L173#8", "L173#4", "130702c1", "130703c1","130712c1",
        "130717c0", "130814c0", "Cha-F-000317", "Cha-F-700170", "E0585-F-300033", "E0585-F-300040",
        "E0585-F-300047", "E0585-F-300070", "E0585-F-400002", "E0585-F-400005", "E0585-F-400011",
        "E0585-F-400025", "Gad1-F-000139", "Gad1-F-100003", "Gad1-F-900052", "L1293#10", "L1293#12","L1293#13",
        "L1293#15", "L1293#3", "L1293#4", "L1293#5", "L1293#6", "L1293#7","L1293#9","L173#3","L173#5","L173#6",
        "L173#9", "L178#1", "L178#3", "L178#4", "JJ98")
gs[c(h,h.h),"cell.type"] = "PV5h"

i = c("360254994", "361269751", "391273276", "573328182")
i.i = c("130605c1", "L1293#11", "L1293#8", "L173#1","121227c2", "JJ137")
gs[c(i,i.i),"cell.type"] = "PV5i"

j = c("732354059", "768132738", "611620813", "763034485")
j.j = c("130617c3", "131126c3", "121217c0", "130211c3", "130617c3",
        "131126c3", "131204c0", "Cha-F-300025", "JJ117", "JJ134")
gs[j,"cell.type"] = "PV5j"

k = c("705722260", "575750788", "701577869", "851027931")
k.k = c("L849#2", "E0585-F-400028", "E0585-F-700002", "Cha-F-300342", "E0585-F-400029",
        "L849#1")
gs[c(k,k.k),"cell.type"] = "PV5k"

l = c("912049625", "456083341", "5812981168")
gs[l,"cell.type"] = "PV5l"

m = c("573005505", "487795196", "5813048346")
m.m = c("Cha-F-700258", "Cha-F-700258", "Cha-F-700258")
gs[m,"cell.type"] = "PV5m"

n = c("484355342", "794333532")
n.n = c("E0585-F-400001")
gs[c(n,n.n),"cell.type"] = "PV5n"

o = c("611274992", "641631806", "641631962")
gs[o,"cell.type"] = "PV5o"

p = c("487467388", "580244333", "5813047222")
p.p = c("Cha-F-200204", "E0585-F-700001", "E0585-F-800004")
gs[c(p,p.p),"cell.type"] = "PV5p"

q = c("5813048099", "697853509", "360587642", "361964245")
q.q = c("Gad1-F-400162", "Gad1-F-300243", "E0585-F-500010", "E0585-F-600005", "E0585-F-600004",
        "E0585-F-400015", "E0585-F-500000", "E0585-F-500001", "E0585-F-800001")
gs[c(q,q.q),"cell.type"] = "PV5q"

r = c("482974860", "731917767")
r.r = c("E0585-F-300063", "130425c1", "121130c0", "130213c0", "130214c1")
gs[c(r,r.r),"cell.type"] = "PV5r"

s = c("5901196176", "634741770")
s.s = c("Cha-F-100264", "E0585-F-300066",
        "E0585-F-400021", "E0585-F-400003")
gs[c(s,s.s),"cell.type"] = "PV5r"

t = "454706029"
t.t = c("160121c1", "Cha-F-200082")
gs[c(t,t.t),"cell.type"] = "PV5t"

u = c("513050445")
u.u = c("Gad1-F-300163","120605c0","E0585-F-300064", "E0585-F-600002","VGlut-F-700001")
gs[c(u,u.u),"cell.type"] = "PV5u"

v = c("513058708")
v.v = c("Cha-F-200276")
gs[c(v,v.v),"cell.type"] = "PV5v"

w = c("730325440")
w.w = c("Cha-F-100083", "Cha-F-200169")
gs[c(w,w.w),"cell.type"] = "PV5w"


############
### PV5z ###
############

a = "5812981840"
gs[a,"cell.type"] = "PV5a"

b = "611288467" # descending
gs[b,"cell.type"] = "PV5b"

c =  "608628936"
c.c = c("Gad1-F-400166")
gs[c(c,c.c),"cell.type"] = "PV5c"

d = "608922563" # Descending
d.d = c("Gad1-F-200219")
gs[c(d,d.d),"cell.type"] = "PV5d"

d = "5813010836"
gs[d,"cell.type"] = "PV5d"



########
# save #
########
write_lhns(gs, pv5x)
write_lhns(gs, pv5y)
write_lhns(gs, pv5z)


